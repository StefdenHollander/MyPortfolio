<!DOCTYPE html>
<html>

<head>
    <title>Shader Card</title>
    <style>
        /* Add your CSS styles here */
        .shader-card {
            width: 200px;
            height: 200px;
            border: 1px solid black;
            margin: 10px;
        }
        .shader-canvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <!-- Shader Card -->
    <div class="shader-card">
        <canvas id="glCanvas" class="shader-canvas"></canvas>
        <textarea id="shaderCode" rows="4" cols="50">void main() {
            gl_FragColor = vec4(gl_FragCoord.x / 200.0, gl_FragCoord.y / 200.0, 0.0, 1.0);
        }</textarea>
        <button id="updateButton">Update Shader</button>
    </div>

    <script>
        // Get the canvas element and its WebGL context
        const canvas = document.getElementById('glCanvas');
        const gl = canvas.getContext('webgl');

        // Create a buffer for the position attribute
        const positionBuffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
        gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
            -1.0, -1.0,
             1.0, -1.0,
            -1.0,  1.0,
            -1.0,  1.0,
             1.0, -1.0,
             1.0,  1.0,
        ]), gl.STATIC_DRAW);

        // Function to compile a shader
        function compileShader(type, source) {
            const shader = gl.createShader(type);
            gl.shaderSource(shader, source);
            gl.compileShader(shader);
            if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
                alert('An error occurred compiling the shaders: ' + gl.getShaderInfoLog(shader));
                gl.deleteShader(shader);
                return null;
            }
            return shader;
        }

        // Function to create a shader program
        function createProgram(vertexShader, fragmentShader) {
            const program = gl.createProgram();
            gl.attachShader(program, vertexShader);
            gl.attachShader(program, fragmentShader);
            gl.linkProgram(program);
            if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {
                alert('Unable to initialize the shader program: ' + gl.getProgramInfoLog(program));
                return null;
            }
            return program;
        }

        // Function to draw the scene
        function drawScene(program) {
            gl.clearColor(0.0, 0.0, 0.0, 1.0);
            gl.clear(gl.COLOR_BUFFER_BIT);

            gl.useProgram(program);

            gl.bindBuffer(gl.ARRAY_BUFFER, positionBuffer);
            const positionLocation = gl.getAttribLocation(program, 'a_position');
            gl.enableVertexAttribArray(positionLocation);
            gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);

            gl.drawArrays(gl.TRIANGLES, 0, 6);
        }

        // Initial draw
        const vertexShader = compileShader(gl.VERTEX_SHADER, `attribute vec2 a_position;
            void main() {
                gl_Position = vec4(a_position, 0.0, 1.0);
            }`);
        let fragmentShader = compileShader(gl.FRAGMENT_SHADER, document.getElementById('shaderCode').value);
        let program = createProgram(vertexShader, fragmentShader);
        drawScene(program);

        // Update the shader when the button is clicked
        document.getElementById('updateButton').addEventListener('click', function() {
            const newShaderCode = document.getElementById('shaderCode').value;
            fragmentShader = compileShader(gl.FRAGMENT_SHADER, newShaderCode);
            program = createProgram(vertexShader, fragmentShader);
            drawScene(program);
        });
    </script>
    
</body>

</html>
